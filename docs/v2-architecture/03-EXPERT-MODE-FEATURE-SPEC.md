# Feature Specification: Expert Mode & Collaboration

## Saline Aquifer Analytics V2.0

**Document Version:** 1.0
**Last Updated:** January 2026
**Status:** Product Requirements Document (PRD)

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [User Research Insights](#2-user-research-insights)
3. [Feature Overview](#3-feature-overview)
4. [Expert Mode Specification](#4-expert-mode-specification)
5. [User Authentication System](#5-user-authentication-system)
6. [Collaboration Features](#6-collaboration-features)
7. [User Interface Design](#7-user-interface-design)
8. [API Specification](#8-api-specification)
9. [Data Model](#9-data-model)
10. [Success Metrics](#10-success-metrics)

---

## 1. Executive Summary

This document specifies two major feature categories for V2.0:

1. **Expert Mode** - A transparency layer enabling technical users (researchers, PhD students) to view, understand, and modify the Cypher queries generated by the AI system.

2. **Collaboration Features** - User accounts with the ability to save analyses, share findings with team members, and build upon previous work through annotations and bookmarks.

These features directly address feedback from V1 User Acceptance Testing, where PhD students specifically requested visibility into the query generation process and the ability to persist their research sessions.

---

## 2. User Research Insights

### 2.1 V1 UAT Feedback Summary

| Feedback Category | User Quote | Frequency |
|-------------------|------------|-----------|
| Query Visibility | "I want to see what Cypher query is being generated so I can understand what went wrong" | 5/8 users |
| Query Control | "Can I modify the query? Sometimes I know what I want but the AI doesn't get it right" | 4/8 users |
| Session Persistence | "I had a great analysis yesterday but now I can't find it" | 6/8 users |
| Team Sharing | "My supervisor needs to see this - can I share a link?" | 3/8 users |
| Learning Curve | "The Cypher queries help me learn how to work with graph databases" | 2/8 users |

### 2.2 User Personas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USER PERSONAS                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ PERSONA 1: Dr. Sarah Chen - Research Scientist                      â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ Role: Post-doctoral researcher in CO2 sequestration                 â”‚    â”‚
â”‚  â”‚ Technical Level: High - comfortable with databases and code         â”‚    â”‚
â”‚  â”‚ Goals:                                                               â”‚    â”‚
â”‚  â”‚   â€¢ Validate AI-generated queries against her domain knowledge      â”‚    â”‚
â”‚  â”‚   â€¢ Export reproducible query logs for publication                  â”‚    â”‚
â”‚  â”‚   â€¢ Build a library of effective query patterns                     â”‚    â”‚
â”‚  â”‚ Pain Points:                                                         â”‚    â”‚
â”‚  â”‚   â€¢ Black-box AI responses reduce trust                             â”‚    â”‚
â”‚  â”‚   â€¢ Cannot reproduce results without seeing the query               â”‚    â”‚
â”‚  â”‚   â€¢ Loses context between sessions                                  â”‚    â”‚
â”‚  â”‚ Feature Needs: Expert Mode + Query History + Export                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ PERSONA 2: Miguel Santos - PhD Candidate                            â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ Role: 3rd year PhD student focusing on risk assessment              â”‚    â”‚
â”‚  â”‚ Technical Level: Medium - learning graph databases                  â”‚    â”‚
â”‚  â”‚ Goals:                                                               â”‚    â”‚
â”‚  â”‚   â€¢ Learn Cypher by observing AI-generated queries                  â”‚    â”‚
â”‚  â”‚   â€¢ Share interesting findings with supervisor                      â”‚    â”‚
â”‚  â”‚   â€¢ Build on previous analyses incrementally                        â”‚    â”‚
â”‚  â”‚ Pain Points:                                                         â”‚    â”‚
â”‚  â”‚   â€¢ No way to save promising leads for later                        â”‚    â”‚
â”‚  â”‚   â€¢ Cannot explain to supervisor how results were obtained          â”‚    â”‚
â”‚  â”‚   â€¢ Repeats same queries across sessions                            â”‚    â”‚
â”‚  â”‚ Feature Needs: Query Display + Saved Analyses + Sharing             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ PERSONA 3: Prof. Amanda Blake - Research Lead                       â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ Role: Principal Investigator overseeing 5 researchers               â”‚    â”‚
â”‚  â”‚ Technical Level: Low - focuses on insights, not implementation      â”‚    â”‚
â”‚  â”‚ Goals:                                                               â”‚    â”‚
â”‚  â”‚   â€¢ Review team findings efficiently                                â”‚    â”‚
â”‚  â”‚   â€¢ Understand methodology without technical deep-dives             â”‚    â”‚
â”‚  â”‚   â€¢ Provide feedback on analysis directions                         â”‚    â”‚
â”‚  â”‚ Pain Points:                                                         â”‚    â”‚
â”‚  â”‚   â€¢ No aggregated view of team analyses                             â”‚    â”‚
â”‚  â”‚   â€¢ Cannot comment on or redirect research                          â”‚    â”‚
â”‚  â”‚   â€¢ Results arrive via email/screenshots (not ideal)                â”‚    â”‚
â”‚  â”‚ Feature Needs: Shared Workspaces + Comments + Simple View           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Feature Overview

### 3.1 Feature Matrix

| Feature | Description | Priority | Effort |
|---------|-------------|----------|--------|
| **Expert Mode** ||||
| Query Display | Show generated Cypher query with syntax highlighting | P0 | M |
| Query Editing | Allow users to modify and re-execute queries | P0 | L |
| Execution Trace | Show agent reasoning and retry attempts | P1 | M |
| Query Explanation | Natural language explanation of query logic | P1 | S |
| **Authentication** ||||
| Email/Password Auth | Basic authentication with verification | P0 | M |
| OAuth (Google) | Social login for convenience | P1 | S |
| Role-Based Access | Admin, Researcher, Viewer roles | P1 | M |
| **Collaboration** ||||
| Save Analysis | Persist chat sessions with title and tags | P0 | M |
| Analysis Library | Browse and search saved analyses | P0 | M |
| Share Link | Generate shareable URL for analysis | P0 | S |
| Team Workspaces | Group analyses by research project | P1 | L |
| Comments & Annotations | Add notes to specific responses | P2 | M |
| Export | Download analysis as PDF/Markdown | P1 | M |

*Priority: P0=Must Have, P1=Should Have, P2=Nice to Have*
*Effort: S=Small (<1 week), M=Medium (1-2 weeks), L=Large (2-4 weeks)*

### 3.2 Feature Dependencies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FEATURE DEPENDENCY GRAPH                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚                           [Authentication]                                   â”‚
â”‚                                  â”‚                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â”‚             â”‚             â”‚                            â”‚
â”‚                    â–¼             â–¼             â–¼                            â”‚
â”‚             [User Profile] [Role System] [Session Mgmt]                     â”‚
â”‚                    â”‚             â”‚             â”‚                            â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                  â”‚                                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚              â”‚                   â”‚                   â”‚                      â”‚
â”‚              â–¼                   â–¼                   â–¼                      â”‚
â”‚       [Save Analysis]    [Expert Mode]      [Team Workspaces]               â”‚
â”‚              â”‚                   â”‚                   â”‚                      â”‚
â”‚              â–¼                   â”‚                   â–¼                      â”‚
â”‚     [Analysis Library]          â”‚            [Invitations]                  â”‚
â”‚              â”‚                   â”‚                   â”‚                      â”‚
â”‚              â–¼                   â–¼                   â–¼                      â”‚
â”‚        [Share Links]     [Query Editing]     [Comments]                     â”‚
â”‚              â”‚                                       â”‚                      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                  â”‚                                           â”‚
â”‚                                  â–¼                                           â”‚
â”‚                             [Export]                                         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Expert Mode Specification

### 4.1 Query Display Panel

**Component Name:** `CypherQueryPanel`

**Behavior:**
- Appears as a collapsible drawer below the AI response
- Default state: collapsed (shows "View Query" button)
- Expert Mode toggle: when enabled, auto-expands for all responses

**Display Elements:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CYPHER QUERY PANEL                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“ Generated Query                                    [Copy] [Edit]    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  1 â”‚ MATCH (a:Aquifer)-[:LOCATED_IN]->(b:Basin)                       â”‚  â”‚
â”‚  â”‚  2 â”‚ WHERE b.name = 'Amazon Basin'                                     â”‚  â”‚
â”‚  â”‚  3 â”‚ RETURN a.name AS aquifer,                                         â”‚  â”‚
â”‚  â”‚  4 â”‚        a.co2_storage_capacity_mt AS capacity,                     â”‚  â”‚
â”‚  â”‚  5 â”‚        a.porosity AS porosity                                     â”‚  â”‚
â”‚  â”‚  6 â”‚ ORDER BY capacity DESC                                            â”‚  â”‚
â”‚  â”‚  7 â”‚ LIMIT 10                                                          â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ’¡ What this query does                                                â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Finds all aquifers located within the Amazon Basin, returning their   â”‚  â”‚
â”‚  â”‚ names, CO2 storage capacities, and porosity values. Results are       â”‚  â”‚
â”‚  â”‚ sorted by capacity (highest first) and limited to 10 records.         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš™ï¸ Execution Details                                    [Expand â–¼]    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Status: âœ… Success                                                     â”‚  â”‚
â”‚  â”‚ Execution Time: 45ms                                                   â”‚  â”‚
â”‚  â”‚ Rows Returned: 10                                                      â”‚  â”‚
â”‚  â”‚ Self-Healing: None required                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Query Editor

**Component Name:** `CypherEditor`

**Requirements:**
- Syntax highlighting for Cypher (use Monaco Editor or CodeMirror)
- Schema-aware autocomplete (labels, properties, relationships)
- Real-time syntax validation (underline errors)
- Keyboard shortcuts: Ctrl+Enter to execute, Ctrl+S to save as template

**Editor Features:**

| Feature | Description |
|---------|-------------|
| Syntax Highlighting | Cypher keywords (MATCH, RETURN, WHERE) in blue; labels in green; properties in purple |
| Autocomplete | Trigger on `:` for labels, `.` for properties, `-[` for relationships |
| Error Indicators | Red underline for syntax errors, yellow for schema warnings |
| Line Numbers | Always visible |
| Minimap | Hidden by default, toggle available |
| Theme | Dark mode with Monokai-style colors |

**User Flow for Query Editing:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       QUERY EDITING USER FLOW                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   [1] User sees AI response with query panel                                 â”‚
â”‚              â”‚                                                               â”‚
â”‚              â–¼                                                               â”‚
â”‚   [2] Clicks "Edit" button on query                                          â”‚
â”‚              â”‚                                                               â”‚
â”‚              â–¼                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Query Editor Modal                                                    â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚   â”‚  â”‚ [Monaco Editor with Cypher code]                                â”‚ â”‚  â”‚
â”‚   â”‚  â”‚                                                                  â”‚ â”‚  â”‚
â”‚   â”‚  â”‚ MATCH (a:Aquifer)-[:LOCATED_IN]->(b:Basin)                      â”‚ â”‚  â”‚
â”‚   â”‚  â”‚ WHERE b.name = 'Amazon Basin'                                    â”‚ â”‚  â”‚
â”‚   â”‚  â”‚   AND a.co2_storage_capacity_mt > 100  â† User adds this line    â”‚ â”‚  â”‚
â”‚   â”‚  â”‚ RETURN a.name, a.co2_storage_capacity_mt                        â”‚ â”‚  â”‚
â”‚   â”‚  â”‚ ORDER BY a.co2_storage_capacity_mt DESC                         â”‚ â”‚  â”‚
â”‚   â”‚  â”‚                                                                  â”‚ â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚  [Validate] [Run Query] [Cancel]                                     â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â”‚                                                               â”‚
â”‚              â–¼                                                               â”‚
â”‚   [3] User modifies query and clicks "Run Query"                             â”‚
â”‚              â”‚                                                               â”‚
â”‚              â–¼                                                               â”‚
â”‚   [4] System executes modified query through Validator Agent                 â”‚
â”‚              â”‚                                                               â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[Valid]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  [5a] Show results inline         â”‚
â”‚              â”‚                                                               â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[Error]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  [5b] Show error with suggestion  â”‚
â”‚                                                    â”‚                         â”‚
â”‚                                                    â–¼                         â”‚
â”‚                                             [6] Offer to auto-fix            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Execution Trace (Advanced Expert Mode)

**Component Name:** `ExecutionTrace`

For power users who want to understand the full agent workflow:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EXECUTION TRACE                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Timeline View:                                                              â”‚
â”‚                                                                              â”‚
â”‚  â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€         â”‚
â”‚    â”‚               â”‚                â”‚             â”‚             â”‚            â”‚
â”‚  Start          Planner        Cypher Gen     Validator      Analyst         â”‚
â”‚  0ms            +120ms          +380ms         +520ms        +890ms          â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ§  Planner Agent                                           120ms       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Classification: SIMPLE                                                  â”‚ â”‚
â”‚  â”‚ Reasoning: "Single entity lookup with filter, no decomposition needed" â”‚ â”‚
â”‚  â”‚ Sub-tasks: 1                                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš¡ Cypher Specialist                                       260ms       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Pattern Used: "Basin Lookup with Aquifer Join"                          â”‚ â”‚
â”‚  â”‚ Query Generated: [See query panel above]                                â”‚ â”‚
â”‚  â”‚ Optimization: Using index on Basin.name                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ… Validator Agent                                         140ms       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Syntax Check: âœ“ Passed                                                  â”‚ â”‚
â”‚  â”‚ Schema Check: âœ“ Passed                                                  â”‚ â”‚
â”‚  â”‚ Execution: âœ“ Success (45ms, 10 rows)                                    â”‚ â”‚
â”‚  â”‚ Self-Healing: Not required                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“Š Analyst Agent                                           370ms       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Insights Generated: 3                                                   â”‚ â”‚
â”‚  â”‚ Recommendations: 2                                                      â”‚ â”‚
â”‚  â”‚ Visualization Hints: ["bar_chart", "map"]                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 Expert Mode Settings

| Setting | Type | Default | Description |
|---------|------|---------|-------------|
| `expert_mode_enabled` | boolean | false | Master toggle for expert features |
| `auto_expand_queries` | boolean | true | Automatically show query panel |
| `show_execution_trace` | boolean | false | Show detailed agent timeline |
| `syntax_theme` | enum | "monokai" | Editor color theme |
| `query_explanation_level` | enum | "simple" | "simple" or "detailed" explanations |

---

## 5. User Authentication System

### 5.1 Authentication Methods

**Primary:** Email + Password with verification
**Secondary:** Google OAuth 2.0

### 5.2 User Registration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REGISTRATION FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   [Landing Page]                                                             â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                      Create Account                                   â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚   â”‚ Continue with Google                                 ğŸ”µ     â”‚    â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ or â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚   Email:     [_________________________________]                      â”‚  â”‚
â”‚   â”‚   Password:  [_________________________________] ğŸ‘ï¸                   â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚   â–¡ I agree to Terms of Service and Privacy Policy                   â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚   â”‚              Create Account                                  â”‚    â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â”‚   Already have an account? Sign in                                   â”‚  â”‚
â”‚   â”‚                                                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚   [Email Verification]                                                       â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚   [Onboarding: Research Focus Selection]                                     â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚   [Dashboard]                                                                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Role-Based Access Control (RBAC)

| Role | Permissions | Description |
|------|-------------|-------------|
| **Viewer** | View shared analyses, read-only | For stakeholders receiving shared links |
| **Researcher** | Full chat access, save analyses, share, edit own queries | Standard user role |
| **Team Lead** | All Researcher + manage team workspace, view team activity | Research group leaders |
| **Admin** | All + user management, system config, audit logs | System administrators |

### 5.4 JWT Token Structure

```json
{
  "sub": "user_id_uuid",
  "email": "sarah.chen@university.edu",
  "role": "researcher",
  "workspace_ids": ["ws_123", "ws_456"],
  "expert_mode": true,
  "iat": 1704067200,
  "exp": 1704153600
}
```

### 5.5 Security Requirements

| Requirement | Implementation |
|-------------|----------------|
| Password Hashing | bcrypt with cost factor 12 |
| Session Tokens | JWT with 24h expiry, refresh tokens with 7d expiry |
| Rate Limiting | 5 login attempts per 15 minutes per IP |
| MFA | Optional TOTP for admin accounts |
| HTTPS | Enforced via ALB, HSTS headers |
| CSRF Protection | SameSite cookies, origin validation |

---

## 6. Collaboration Features

### 6.1 Save Analysis

**Trigger:** User clicks "Save" button on chat session

**Save Dialog:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SAVE ANALYSIS                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Title: [Amazon Basin High-Capacity Aquifer Analysis____________]            â”‚
â”‚                                                                              â”‚
â”‚  Description (optional):                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Investigating top aquifers in Amazon Basin for CO2 storage potential. â”‚ â”‚
â”‚  â”‚ Focus on capacity > 100 Mt with low seismic risk.                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  Tags:                                                                       â”‚
â”‚  [Amazon] [High Capacity] [Risk Assessment] [+Add Tag]                       â”‚
â”‚                                                                              â”‚
â”‚  Workspace: [Personal â–¼]                                                     â”‚
â”‚             â”œâ”€ Personal                                                      â”‚
â”‚             â”œâ”€ CO2 Sequestration Project                                     â”‚
â”‚             â””â”€ Brazil Field Study                                            â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚     Cancel      â”‚  â”‚      Save       â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Analysis Library

**Component Name:** `AnalysisLibrary`

**Views:**
- Grid view (cards with thumbnails)
- List view (table format)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          MY ANALYSES                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  [ğŸ” Search...________________]  [All Tags â–¼] [All Workspaces â–¼] [âŠ] [â‰¡]   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“Š Amazon Basin High-Capacity Analysis                               â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚   â”‚
â”‚  â”‚ Investigating top aquifers in Amazon Basin...                        â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ [Amazon] [High Capacity]                                              â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ ğŸ“… Jan 15, 2026  â”‚  ğŸ’¬ 12 messages  â”‚  ğŸ”— Shared with 2               â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ [Open]  [Share]  [Export]  [â‹¯]                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ—ºï¸ Brazil Coastal Aquifer Risk Assessment                            â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚   â”‚
â”‚  â”‚ Risk analysis for coastal aquifers considering seismic...            â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ [Brazil] [Coastal] [Risk Assessment]                                  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ ğŸ“… Jan 10, 2026  â”‚  ğŸ’¬ 8 messages  â”‚  ğŸ”’ Private                       â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚ [Open]  [Share]  [Export]  [â‹¯]                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  Showing 1-10 of 24 analyses                          [< Prev] [Next >]     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 Share Analysis

**Share Options:**

| Option | Description | Access Level |
|--------|-------------|--------------|
| Private Link | Anyone with link can view (read-only) | Viewer |
| Email Invite | Invite specific users with role selection | Viewer/Collaborator |
| Workspace | Add to team workspace | Inherits workspace role |
| Public | Visible in public gallery (future) | Viewer |

**Share Dialog:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SHARE ANALYSIS                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  "Amazon Basin High-Capacity Analysis"                                       â”‚
â”‚                                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                              â”‚
â”‚  Share via Link:                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ https://aquifer.app/share/abc123xyz789                     â”‚  â”‚ Copy â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  Anyone with this link can: [View Only â–¼]                                   â”‚
â”‚                                                                              â”‚
â”‚  â–¡ Allow viewers to copy analysis to their library                          â”‚
â”‚  â–¡ Link expires after: [Never â–¼]                                            â”‚
â”‚                                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                              â”‚
â”‚  Invite People:                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Enter email addresses...                                   â”‚  â”‚ Send â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  Already shared with:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ‘¤ prof.blake@university.edu              [Viewer â–¼]        [Remove]  â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ miguel.santos@university.edu           [Can Edit â–¼]      [Remove]  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚      Done       â”‚                                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 Comments & Annotations

**Feature:** Add contextual notes to specific AI responses or data points.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI Response with Annotation                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Based on the analysis, the **SolimÃµes Aquifer** in the Amazon Basin        â”‚
â”‚  shows the highest potential with:                                           â”‚
â”‚  - CO2 Storage Capacity: 847 Mt                                             â”‚
â”‚  - Porosity: 28%                                                             â”‚
â”‚  - Risk Level: LOW â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                                            â”‚                                 â”‚
â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                                 â”‚ ğŸ’¬ Comment           â”‚                     â”‚
â”‚                                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
â”‚                                 â”‚ Prof. Blake:        â”‚                     â”‚
â”‚                                 â”‚ "Verify this with   â”‚                     â”‚
â”‚                                 â”‚ 2024 seismic data"  â”‚                     â”‚
â”‚                                 â”‚                     â”‚                     â”‚
â”‚                                 â”‚ [Reply] [Resolve]   â”‚                     â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.5 Export Options

| Format | Contents | Use Case |
|--------|----------|----------|
| PDF | Full conversation with visualizations | Reports, presentations |
| Markdown | Text with Cypher code blocks | Documentation, GitHub |
| JSON | Structured data with queries and results | Programmatic access |
| CSV | Query results only | Further analysis in Excel/Python |

---

## 7. User Interface Design

### 7.1 Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ HEADER                                                                   â”‚ â”‚
â”‚ â”‚ [Logo]  [New Analysis]  [My Library]          [Expert Mode ğŸ”˜] [ğŸ‘¤ User] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚              â”‚                                                           â”‚ â”‚
â”‚ â”‚   SIDEBAR    â”‚                    MAIN CONTENT                           â”‚ â”‚
â”‚ â”‚              â”‚                                                           â”‚ â”‚
â”‚ â”‚  Recent      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚                                                    â”‚   â”‚ â”‚
â”‚ â”‚  â€¢ Analysis1 â”‚  â”‚                   CHAT AREA                        â”‚   â”‚ â”‚
â”‚ â”‚  â€¢ Analysis2 â”‚  â”‚                                                    â”‚   â”‚ â”‚
â”‚ â”‚  â€¢ Analysis3 â”‚  â”‚  [AI Response with Charts/Maps]                    â”‚   â”‚ â”‚
â”‚ â”‚              â”‚  â”‚                                                    â”‚   â”‚ â”‚
â”‚ â”‚  Workspaces  â”‚  â”‚  â”Œâ”€ Cypher Query Panel (Expert Mode) â”€â”            â”‚   â”‚ â”‚
â”‚ â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚  â”‚ [Query Code]                       â”‚            â”‚   â”‚ â”‚
â”‚ â”‚  ğŸ“ Personal â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚ â”‚
â”‚ â”‚  ğŸ“ Project1 â”‚  â”‚                                                    â”‚   â”‚ â”‚
â”‚ â”‚  ğŸ“ Project2 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚              â”‚                                                           â”‚ â”‚
â”‚ â”‚  Quick       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚  Actions     â”‚  â”‚                  INPUT AREA                        â”‚   â”‚ â”‚
â”‚ â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚  [Type your question...              ] [Send â–¶]   â”‚   â”‚ â”‚
â”‚ â”‚  + New       â”‚  â”‚  [ğŸ“ Attach] [ğŸ¤ Voice] [ğŸ“‹ Templates]              â”‚   â”‚ â”‚
â”‚ â”‚  ğŸ“¤ Export   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚              â”‚                                                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Responsive Breakpoints

| Breakpoint | Layout | Sidebar |
|------------|--------|---------|
| Desktop (â‰¥1200px) | Side-by-side | Always visible |
| Tablet (768-1199px) | Side-by-side | Collapsible |
| Mobile (<768px) | Stacked | Drawer overlay |

### 7.3 Component Library

**Framework:** React 18 with TypeScript
**UI Library:** shadcn/ui (Radix primitives + Tailwind)
**State Management:** Zustand
**Data Fetching:** TanStack Query (React Query)

---

## 8. API Specification

### 8.1 Authentication Endpoints

```yaml
# POST /api/v2/auth/register
Request:
  email: string
  password: string (min 8 chars, 1 uppercase, 1 number)
Response:
  user_id: uuid
  message: "Verification email sent"

# POST /api/v2/auth/login
Request:
  email: string
  password: string
Response:
  access_token: string (JWT)
  refresh_token: string
  expires_in: number (seconds)
  user: {id, email, role, expert_mode}

# POST /api/v2/auth/refresh
Request:
  refresh_token: string
Response:
  access_token: string
  expires_in: number

# POST /api/v2/auth/logout
Request:
  refresh_token: string
Response:
  message: "Logged out successfully"

# GET /api/v2/auth/me
Response:
  user: {id, email, name, role, expert_mode, created_at}
```

### 8.2 Analysis Management Endpoints

```yaml
# POST /api/v2/analyses
Create new saved analysis
Request:
  session_id: string
  title: string
  description?: string
  tags?: string[]
  workspace_id?: uuid
Response:
  analysis_id: uuid
  share_url: string (auto-generated)

# GET /api/v2/analyses
List user's analyses
Query Params:
  workspace_id?: uuid
  tags?: string (comma-separated)
  search?: string
  page?: number
  limit?: number
Response:
  analyses: Analysis[]
  total: number
  page: number

# GET /api/v2/analyses/{id}
Get single analysis with full conversation
Response:
  id: uuid
  title: string
  description: string
  tags: string[]
  messages: Message[]
  created_at: timestamp
  updated_at: timestamp
  owner: {id, name, email}
  collaborators: Collaborator[]

# DELETE /api/v2/analyses/{id}
Delete analysis (owner only)
Response:
  message: "Analysis deleted"

# POST /api/v2/analyses/{id}/share
Create or update share settings
Request:
  type: "link" | "invite"
  permission: "view" | "edit"
  emails?: string[] (for invite type)
  expires_at?: timestamp
Response:
  share_url: string
  invites_sent?: number
```

### 8.3 Expert Mode Endpoints

```yaml
# POST /api/v2/queries/execute
Execute custom Cypher query
Request:
  query: string
  parameters?: object
  session_id?: string
Response:
  results: object[]
  execution_time_ms: number
  warnings?: string[]

# POST /api/v2/queries/validate
Validate query without executing
Request:
  query: string
Response:
  valid: boolean
  errors?: ValidationError[]
  suggestions?: string[]

# GET /api/v2/schema
Get current Neo4j schema for autocomplete
Response:
  labels: Label[]
  relationships: Relationship[]
  properties: Property[]
```

### 8.4 Collaboration Endpoints

```yaml
# POST /api/v2/analyses/{id}/comments
Add comment to analysis
Request:
  message_id?: string (specific message to comment on)
  content: string
Response:
  comment_id: uuid
  created_at: timestamp

# GET /api/v2/workspaces
List user's workspaces
Response:
  workspaces: Workspace[]

# POST /api/v2/workspaces
Create workspace
Request:
  name: string
  description?: string
Response:
  workspace_id: uuid

# POST /api/v2/workspaces/{id}/invite
Invite user to workspace
Request:
  email: string
  role: "viewer" | "member" | "admin"
Response:
  invite_id: uuid
  message: "Invitation sent"
```

---

## 9. Data Model

### 9.1 PostgreSQL Schema

```sql
-- Users table
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),
    name VARCHAR(255),
    role VARCHAR(50) DEFAULT 'researcher',
    expert_mode_enabled BOOLEAN DEFAULT FALSE,
    expert_settings JSONB DEFAULT '{}',
    google_id VARCHAR(255),
    email_verified BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Workspaces for team collaboration
CREATE TABLE workspaces (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    description TEXT,
    owner_id UUID REFERENCES users(id) ON DELETE SET NULL,
    settings JSONB DEFAULT '{}',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Workspace membership
CREATE TABLE workspace_members (
    workspace_id UUID REFERENCES workspaces(id) ON DELETE CASCADE,
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    role VARCHAR(50) DEFAULT 'member',
    joined_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    PRIMARY KEY (workspace_id, user_id)
);

-- Saved analyses
CREATE TABLE analyses (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    session_id VARCHAR(255) NOT NULL,
    owner_id UUID REFERENCES users(id) ON DELETE SET NULL,
    workspace_id UUID REFERENCES workspaces(id) ON DELETE SET NULL,
    title VARCHAR(500) NOT NULL,
    description TEXT,
    tags TEXT[],
    share_token VARCHAR(64) UNIQUE,
    share_permission VARCHAR(50) DEFAULT 'view',
    share_expires_at TIMESTAMP WITH TIME ZONE,
    is_public BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Chat messages (enhanced from V1)
CREATE TABLE chat_messages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    session_id VARCHAR(255) NOT NULL,
    role VARCHAR(50) NOT NULL,  -- 'user' | 'assistant'
    content TEXT NOT NULL,
    cypher_query TEXT,
    cypher_explanation TEXT,
    execution_trace JSONB,
    query_results JSONB,
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Comments on analyses
CREATE TABLE comments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    analysis_id UUID REFERENCES analyses(id) ON DELETE CASCADE,
    message_id UUID REFERENCES chat_messages(id) ON DELETE CASCADE,
    author_id UUID REFERENCES users(id) ON DELETE SET NULL,
    content TEXT NOT NULL,
    resolved BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Analysis shares (for direct user invites)
CREATE TABLE analysis_shares (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    analysis_id UUID REFERENCES analyses(id) ON DELETE CASCADE,
    shared_with_id UUID REFERENCES users(id) ON DELETE CASCADE,
    permission VARCHAR(50) DEFAULT 'view',
    invited_by_id UUID REFERENCES users(id) ON DELETE SET NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    UNIQUE(analysis_id, shared_with_id)
);

-- Refresh tokens
CREATE TABLE refresh_tokens (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    token_hash VARCHAR(255) NOT NULL,
    expires_at TIMESTAMP WITH TIME ZONE NOT NULL,
    revoked BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Indexes for performance
CREATE INDEX idx_analyses_owner ON analyses(owner_id);
CREATE INDEX idx_analyses_workspace ON analyses(workspace_id);
CREATE INDEX idx_analyses_tags ON analyses USING GIN(tags);
CREATE INDEX idx_analyses_share_token ON analyses(share_token);
CREATE INDEX idx_messages_session ON chat_messages(session_id);
CREATE INDEX idx_comments_analysis ON comments(analysis_id);
CREATE INDEX idx_refresh_tokens_user ON refresh_tokens(user_id);
```

### 9.2 TypeScript Interfaces

```typescript
// types/models.ts

interface User {
  id: string;
  email: string;
  name: string;
  role: 'viewer' | 'researcher' | 'team_lead' | 'admin';
  expertModeEnabled: boolean;
  expertSettings: ExpertSettings;
  createdAt: Date;
}

interface ExpertSettings {
  autoExpandQueries: boolean;
  showExecutionTrace: boolean;
  syntaxTheme: 'monokai' | 'github' | 'solarized';
  queryExplanationLevel: 'simple' | 'detailed';
}

interface Analysis {
  id: string;
  sessionId: string;
  title: string;
  description?: string;
  tags: string[];
  owner: User;
  workspace?: Workspace;
  messages: ChatMessage[];
  collaborators: Collaborator[];
  shareUrl?: string;
  sharePermission: 'private' | 'view' | 'edit';
  createdAt: Date;
  updatedAt: Date;
}

interface ChatMessage {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  cypherQuery?: string;
  cypherExplanation?: string;
  executionTrace?: ExecutionTrace;
  queryResults?: Record<string, any>[];
  comments: Comment[];
  createdAt: Date;
}

interface ExecutionTrace {
  totalTimeMs: number;
  agents: AgentTrace[];
}

interface AgentTrace {
  name: 'planner' | 'cypher_specialist' | 'validator' | 'analyst';
  durationMs: number;
  output: Record<string, any>;
  retries?: number;
}

interface Comment {
  id: string;
  author: User;
  content: string;
  resolved: boolean;
  createdAt: Date;
}

interface Workspace {
  id: string;
  name: string;
  description?: string;
  owner: User;
  members: WorkspaceMember[];
  analyses: Analysis[];
  createdAt: Date;
}

interface WorkspaceMember {
  user: User;
  role: 'viewer' | 'member' | 'admin';
  joinedAt: Date;
}
```

---

## 10. Success Metrics

### 10.1 Key Performance Indicators (KPIs)

| Metric | Target | Measurement |
|--------|--------|-------------|
| **Expert Mode Adoption** | 40% of active users enable | `users with expert_mode = true / active users` |
| **Query Edit Rate** | 15% of queries edited | `edited queries / total queries` |
| **Save Rate** | 25% of sessions saved | `saved analyses / total sessions` |
| **Share Rate** | 10% of saved analyses shared | `shared analyses / saved analyses` |
| **Return Rate** | 60% of users return within 7 days | Cohort analysis |
| **Query Success Rate** | 95%+ (up from 85%) | Validator agent metrics |

### 10.2 Analytics Events

```typescript
// analytics/events.ts

type AnalyticsEvent =
  | { type: 'expert_mode_enabled' }
  | { type: 'expert_mode_disabled' }
  | { type: 'query_viewed'; queryId: string }
  | { type: 'query_copied'; queryId: string }
  | { type: 'query_edited'; queryId: string; editType: 'minor' | 'major' }
  | { type: 'query_executed'; queryId: string; success: boolean; retries: number }
  | { type: 'analysis_saved'; analysisId: string; tags: string[] }
  | { type: 'analysis_shared'; analysisId: string; shareType: 'link' | 'invite' }
  | { type: 'analysis_exported'; analysisId: string; format: string }
  | { type: 'comment_added'; analysisId: string }
  | { type: 'workspace_created'; workspaceId: string }
  | { type: 'user_invited'; workspaceId: string };
```

### 10.3 User Feedback Collection

- In-app feedback widget (bottom-right corner)
- Post-session CSAT survey (after 5th message)
- Monthly NPS survey for active users
- Expert mode specific feedback: "Did this query explanation help?"

---

## Appendix A: Cypher Syntax Highlighting Rules

```javascript
// Monaco Editor Cypher language definition
{
  keywords: [
    'MATCH', 'OPTIONAL', 'WHERE', 'RETURN', 'ORDER', 'BY',
    'LIMIT', 'SKIP', 'CREATE', 'DELETE', 'SET', 'REMOVE',
    'MERGE', 'WITH', 'UNWIND', 'UNION', 'CALL', 'YIELD',
    'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'AND', 'OR',
    'NOT', 'IN', 'STARTS', 'ENDS', 'CONTAINS', 'AS',
    'DISTINCT', 'TRUE', 'FALSE', 'NULL', 'ASC', 'DESC'
  ],
  labels: /:[A-Z][a-zA-Z0-9]*/,
  properties: /\.[a-z][a-zA-Z0-9_]*/,
  variables: /[a-z][a-zA-Z0-9]*/,
  strings: /'[^']*'|"[^"]*"/,
  numbers: /\d+(\.\d+)?/,
  operators: ['=', '<>', '<', '>', '<=', '>=', '+', '-', '*', '/']
}
```

---

**Document End**

*This feature specification provides a comprehensive blueprint for implementing Expert Mode and Collaboration features in V2.0, directly addressing the feedback received during V1 User Acceptance Testing.*
